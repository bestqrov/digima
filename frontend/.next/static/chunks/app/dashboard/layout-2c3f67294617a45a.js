(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[663],{2413:function(e,s,r){Promise.resolve().then(r.bind(r,4174))},4174:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return v}});var a={};r.r(a);var t=r(7437),n=r(2265),i=r(9376),l=r(954),c=r(3519);function d(e){let{children:s,roles:r=[],fallbackUrl:a="/login"}=e,d=(0,i.useRouter)(),{isAuthenticated:o,isLoading:m,user:h,checkAuth:x}=(0,l.tN)();return((0,n.useEffect)(()=>{x()},[x]),m)?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)(c.Z,{size:"lg"})}):o?r.length>0&&h&&!r.includes(h.role)?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Access Denied"}),(0,t.jsx)("p",{className:"text-gray-600 mb-6",children:"You don't have permission to access this page."}),(0,t.jsx)("button",{onClick:()=>d.back(),className:"btn-primary",children:"Go Back"})]})}):(0,t.jsx)(t.Fragment,{children:s}):(d.push(a),null)}var o=r(7648),m=r(9778),h=r(9289),x=r(3730),u=r(2930),f=r(8081),g=r(9681),p=r(4508);let b=[{name:"Dashboard",href:"/dashboard",icon:m.Z},{name:"Vehicles",href:"/dashboard/vehicles",icon:h.Z},{name:"Trips",href:"/dashboard/trips",icon:x.Z},{name:"Users",href:"/dashboard/users",icon:u.Z,roles:["super_admin","agency_admin"]},{name:"Subscription",href:"/dashboard/subscription",icon:f.Z},{name:"Agencies",href:"/dashboard/agencies",icon:g.Z,roles:["super_admin"]}];function j(){var e,s;let[r,c]=(0,n.useState)(!1),d=(0,i.usePathname)(),{user:m,logout:x}=(0,l.tN)(),u=b.filter(e=>!e.roles||(null==m?void 0:m.role)&&e.roles.includes(m.role));return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"lg:hidden fixed top-4 left-4 z-50",children:(0,t.jsx)("button",{type:"button",className:"bg-white p-2 rounded-md shadow-md text-gray-600 hover:text-gray-900 hover:bg-gray-50",onClick:()=>c(!r),children:r?(0,t.jsx)(a.XIcon,{className:"h-6 w-6","aria-hidden":"true"}):(0,t.jsx)(a.MenuIcon,{className:"h-6 w-6","aria-hidden":"true"})})}),r&&(0,t.jsx)("div",{className:"lg:hidden fixed inset-0 z-40 bg-gray-600 bg-opacity-75",onClick:()=>c(!1)}),(0,t.jsx)("div",{className:(0,p.cn)("fixed inset-y-0 left-0 z-40 w-64 bg-white shadow-lg transform transition-transform duration-200 ease-in-out lg:transform-none lg:translate-x-0",r?"translate-x-0":"-translate-x-full"),children:(0,t.jsxs)("div",{className:"flex flex-col h-full",children:[(0,t.jsx)("div",{className:"flex items-center px-6 py-4 border-b border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-primary-600 rounded-lg flex items-center justify-center",children:(0,t.jsx)(h.Z,{className:"w-5 h-5 text-white"})}),(0,t.jsx)("span",{className:"ml-3 text-xl font-bold text-gray-900",children:"ArwaPark"})]})}),(0,t.jsx)("nav",{className:"flex-1 px-4 py-4 space-y-2",children:u.map(e=>{let s=d===e.href||"/dashboard"!==e.href&&d.startsWith(e.href);return(0,t.jsxs)(o.default,{href:e.href,className:(0,p.cn)("group flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors",s?"bg-primary-100 text-primary-700 border-r-2 border-primary-600":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),onClick:()=>c(!1),children:[(0,t.jsx)(e.icon,{className:(0,p.cn)("mr-3 h-5 w-5 flex-shrink-0",s?"text-primary-600":"text-gray-400 group-hover:text-gray-500"),"aria-hidden":"true"}),e.name]},e.name)})}),(0,t.jsxs)("div",{className:"border-t border-gray-200 p-4",children:[(0,t.jsxs)("div",{className:"flex items-center mb-4",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:null==m?void 0:null===(e=m.fullName)||void 0===e?void 0:e.split(" ").map(e=>e[0]).join("").slice(0,2)})}),(0,t.jsxs)("div",{className:"ml-3",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900",children:null==m?void 0:m.fullName}),(0,t.jsx)("p",{className:"text-xs text-gray-500 capitalize",children:null==m?void 0:null===(s=m.role)||void 0===s?void 0:s.replace("_"," ")})]})]}),(0,t.jsxs)("button",{onClick:()=>{x()},className:"w-full flex items-center px-3 py-2 text-sm font-medium text-gray-600 rounded-lg hover:bg-gray-50 hover:text-gray-900 transition-colors",children:[(0,t.jsx)(a.LogoutIcon,{className:"mr-3 h-5 w-5 text-gray-400","aria-hidden":"true"}),"Sign Out"]})]})]})})]})}var y=r(9064);function v(e){let{children:s}=e,r=(0,i.useRouter)(),{user:a,initialize:c}=(0,l.tN)(),{subscription:o,fetchCurrentSubscription:m}=(0,l.ZO)();return(0,n.useEffect)(()=>{c(),m()},[c,m]),(0,n.useEffect)(()=>{if(o){let{status:e}=o;window.location.pathname.includes("/dashboard/subscription")||"active"===e||(y.Am.error("Your subscription is not active. Please update your subscription."),r.push("/dashboard/subscription"))}},[o,r]),(0,t.jsx)(d,{children:(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)(j,{}),(0,t.jsx)("div",{className:"lg:pl-64",children:(0,t.jsx)("main",{className:"flex-1",children:s})})]})})}}},function(e){e.O(0,[64,762,959,480,971,117,744],function(){return e(e.s=2413)}),_N_E=e.O()}]);